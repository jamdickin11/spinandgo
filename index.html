<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spin & Go Poker Coach - Visual Selector</title>
    <style>
        :root {
            --primary: #FF4757;
            --primary-dark: #FF3838;
            --secondary: #2ED573;
            --dark-bg: #1A1D29;
            --dark-card: #252837;
            --darker-card: #1E202E;
            --text: #F1F2F6;
            --text-secondary: #A4B0BE;
            --border: #2F3542;
            --call-color: #2ED573;
            --fold-color: #FF6B81;
            --raise-color: #FFA502;
            --allin-color: #FF4757;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #0F1525 0%, var(--dark-bg) 100%);
            color: var(--text);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 900px) {
            .container {
                grid-template-columns: 1fr;
            }
        }
        
        .panel {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
        }
        
        .panel-title {
            font-size: 24px;
            margin-bottom: 30px;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .panel-title i {
            color: var(--primary);
        }
        
        /* POSITION SELECTOR - SIMPLE RADIO BUTTONS */
        .position-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 30px;
        }
        
        .position-option {
            background: var(--darker-card);
            border: 3px solid transparent;
            border-radius: 15px;
            padding: 20px 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .position-option:hover {
            transform: translateY(-3px);
        }
        
        .position-option.active {
            border-color: var(--primary);
            background: rgba(255, 71, 87, 0.1);
        }
        
        .position-label {
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 5px;
        }
        
        .position-desc {
            font-size: 14px;
            color: var(--text-secondary);
        }
        
        /* STACK INPUT */
        .stack-input {
            background: var(--darker-card);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }
        
        .stack-display {
            font-size: 36px;
            font-weight: 800;
            color: var(--secondary);
            text-align: center;
            margin-bottom: 20px;
        }
        
        .stack-slider {
            width: 100%;
            height: 10px;
            -webkit-appearance: none;
            background: var(--border);
            border-radius: 5px;
            outline: none;
        }
        
        .stack-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            border: 4px solid white;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
        }
        
        /* GAME SETTINGS */
        .game-settings {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .setting-group {
            background: var(--darker-card);
            border-radius: 15px;
            padding: 20px;
        }
        
        .setting-label {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        select {
            width: 100%;
            padding: 15px;
            background: transparent;
            border: 2px solid var(--border);
            border-radius: 10px;
            color: var(--text);
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
        }
        
        select:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        /* CARD SELECTOR - MAIN FEATURE */
        .card-selector-container {
            margin: 30px 0;
        }
        
        .selected-cards {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card-slot {
            width: 120px;
            height: 170px;
            background: var(--darker-card);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            border: 3px dashed var(--border);
            transition: all 0.3s;
        }
        
        .card-slot.filled {
            border-color: var(--primary);
            border-style: solid;
            background: rgba(255, 71, 87, 0.1);
        }
        
        .hand-display {
            text-align: center;
            font-size: 32px;
            font-weight: 800;
            margin: 20px 0;
            color: var(--secondary);
            font-family: 'Courier New', monospace;
        }
        
        /* CARD DECK */
        .card-deck {
            display: grid;
            grid-template-columns: repeat(13, 1fr);
            gap: 8px;
            margin-top: 20px;
        }
        
        @media (max-width: 1200px) {
            .card-deck {
                grid-template-columns: repeat(8, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .card-deck {
                grid-template-columns: repeat(6, 1fr);
            }
        }
        
        .card {
            aspect-ratio: 2/3;
            background: white;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
            font-weight: 800;
        }
        
        .card:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }
        
        .card.selected {
            outline: 4px solid var(--primary);
            outline-offset: 2px;
        }
        
        .card.red {
            color: #FF4757;
        }
        
        .card.black {
            color: #2F3542;
        }
        
        .card-rank {
            font-size: 24px;
            font-weight: 800;
        }
        
        .card-suit {
            font-size: 30px;
            margin-top: 5px;
        }
        
        /* SUIT FILTER */
        .suit-filter {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .suit-btn {
            padding: 10px 20px;
            background: var(--darker-card);
            border-radius: 10px;
            cursor: pointer;
            font-size: 24px;
            transition: all 0.2s;
        }
        
        .suit-btn.active {
            background: var(--primary);
            color: white;
        }
        
        /* ACTION BUTTON */
        .action-button {
            width: 100%;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border: none;
            border-radius: 15px;
            color: white;
            font-size: 24px;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .action-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(255, 71, 87, 0.4);
        }
        
        /* RESULTS PANEL */
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border);
        }
        
        .result-cards {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .result-card {
            width: 100px;
            height: 140px;
            background: white;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            font-weight: 800;
        }
        
        .result-card.red {
            color: #FF4757;
        }
        
        .result-card.black {
            color: #2F3542;
        }
        
        .situation-info {
            background: var(--darker-card);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        
        .info-item {
            text-align: center;
        }
        
        .info-label {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }
        
        .info-value {
            font-size: 20px;
            font-weight: 700;
        }
        
        /* RECOMMENDATION */
        .recommendation-box {
            background: linear-gradient(135deg, var(--darker-card), #1E202E);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            border-left: 8px solid var(--primary);
        }
        
        .recommendation-label {
            font-size: 16px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 15px;
        }
        
        .recommendation-action {
            font-size: 56px;
            font-weight: 900;
            margin: 20px 0;
            text-transform: uppercase;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .allin { color: var(--allin-color); }
        .call { color: var(--call-color); }
        .raise { color: var(--raise-color); }
        .fold { color: var(--fold-color); }
        
        .confidence-meter {
            height: 12px;
            background: var(--border);
            border-radius: 6px;
            margin: 30px 0;
            overflow: hidden;
        }
        
        .confidence-fill {
            height: 100%;
            background: var(--secondary);
            border-radius: 6px;
            transition: width 0.5s ease;
        }
        
        /* CHARTS */
        .charts-panel {
            margin-top: 40px;
            background: var(--darker-card);
            border-radius: 20px;
            padding: 25px;
        }
        
        .chart-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .chart-btn {
            padding: 12px 20px;
            background: var(--border);
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .chart-btn:hover, .chart-btn.active {
            background: var(--primary);
        }
        
        .chart-display {
            background: var(--dark-card);
            border-radius: 15px;
            padding: 20px;
            min-height: 200px;
        }
        
        /* ANIMATIONS */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .slide-in {
            animation: slideIn 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- LEFT PANEL: INPUT -->
        <div class="panel">
            <h2 class="panel-title"><i class="fas fa-gamepad"></i> SETUP YOUR HAND</h2>
            
            <!-- Position -->
            <div class="position-selector">
                <div class="position-option active" data-position="BTN">
                    <div class="position-label">BTN</div>
                    <div class="position-desc">Button</div>
                </div>
                <div class="position-option" data-position="SB">
                    <div class="position-label">SB</div>
                    <div class="position-desc">Small Blind</div>
                </div>
                <div class="position-option" data-position="BB">
                    <div class="position-label">BB</div>
                    <div class="position-desc">Big Blind</div>
                </div>
            </div>
            
            <!-- Stack Size -->
            <div class="stack-input">
                <div class="stack-display" id="stackValue">16 BB</div>
                <input type="range" class="stack-slider" id="stackSlider" min="5" max="30" value="16" step="1">
            </div>
            
            <!-- Game Settings -->
            <div class="game-settings">
                <div class="setting-group">
                    <div class="setting-label">Game Stage</div>
                    <select id="gameStage">
                        <option value="3way">3-Handed (3W)</option>
                        <option value="HU">Heads-Up (HU)</option>
                    </select>
                </div>
                <div class="setting-group">
                    <div class="setting-label">Action Facing</div>
                    <select id="actionFacing">
                        <option value="Fold">Fold to you</option>
                        <option value="Limp">Limp</option>
                        <option value="MR" selected>Min-Raise (2x)</option>
                        <option value="25x">Raise 2.5x</option>
                        <option value="3x">Raise 3x</option>
                        <option value="AI">All-In</option>
                    </select>
                </div>
            </div>
            
            <!-- Card Selector -->
            <div class="card-selector-container">
                <div class="selected-cards">
                    <div class="card-slot" id="cardSlot1">
                        <i class="fas fa-plus" style="color: var(--text-secondary); font-size: 40px;"></i>
                    </div>
                    <div class="card-slot" id="cardSlot2">
                        <i class="fas fa-plus" style="color: var(--text-secondary); font-size: 40px;"></i>
                    </div>
                </div>
                
                <div class="hand-display" id="handDisplay">
                    Select 2 cards
                </div>
                
                <!-- Suit Filter -->
                <div class="suit-filter">
                    <div class="suit-btn active" data-suit="all">All</div>
                    <div class="suit-btn" data-suit="♥" style="color: #FF4757;">♥ Hearts</div>
                    <div class="suit-btn" data-suit="♦" style="color: #FF4757;">♦ Diamonds</div>
                    <div class="suit-btn" data-suit="♠" style="color: #2F3542;">♠ Spades</div>
                    <div class="suit-btn" data-suit="♣" style="color: #2F3542;">♣ Clubs</div>
                </div>
                
                <!-- Card Deck -->
                <div class="card-deck" id="cardDeck">
                    <!-- Cards will be generated by JavaScript -->
                </div>
            </div>
            
            <!-- Action Button -->
            <button class="action-button" id="getAdviceBtn">
                <i class="fas fa-bolt"></i> GET POKER ADVICE
            </button>
        </div>
        
        <!-- RIGHT PANEL: RESULTS -->
        <div class="panel">
            <div class="results-header">
                <h2 class="panel-title"><i class="fas fa-chart-line"></i> RECOMMENDATION</h2>
                <div style="color: var(--text-secondary);">
                    <i class="fas fa-sync-alt"></i> Live Analysis
                </div>
            </div>
            
            <!-- Selected Cards Display -->
            <div class="result-cards" id="resultCards">
                <!-- Cards will appear here -->
            </div>
            
            <!-- Situation Info -->
            <div class="situation-info">
                <div class="info-grid">
                    <div class="info-item">
                        <div class="info-label">Position</div>
                        <div class="info-value" id="infoPosition">BTN</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Stack</div>
                        <div class="info-value" id="infoStack">16 BB</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Stage</div>
                        <div class="info-value" id="infoStage">3-Handed</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Facing</div>
                        <div class="info-value" id="infoAction">Min-Raise</div>
                    </div>
                </div>
            </div>
            
            <!-- Recommendation -->
            <div class="recommendation-box">
                <div class="recommendation-label">Team Bas Chart Says</div>
                <div class="recommendation-action call" id="recommendationAction">
                    CALL
                </div>
                <div id="recommendationExplanation" style="color: var(--text-secondary); margin-bottom: 20px;">
                    3W_SBvsBU_MR_16-20BB Chart
                </div>
                
                <div class="confidence-meter">
                    <div class="confidence-fill" id="confidenceBar" style="width: 95%"></div>
                </div>
                <div style="color: var(--text-secondary); font-size: 14px;">
                    <span>Low Confidence</span>
                    <span style="float: right;">High Confidence</span>
                </div>
            </div>
            
            <!-- Charts -->
            <div class="charts-panel">
                <div class="setting-label">Available Charts</div>
                <div class="chart-buttons" id="chartButtons">
                    <!-- Charts will be added here -->
                </div>
                <div class="chart-display" id="chartDisplay">
                    Select a chart to view hand ranges
                </div>
            </div>
        </div>
    </div>

    <!-- Font Awesome for Icons -->
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

    <script>
        // ============================================
        // 1. CARD DATA AND INITIALIZATION
        // ============================================
        const ranks = ['A', 'K', 'Q', 'J', 'T', '9', '8', '7', '6', '5', '4', '3', '2'];
        const suits = [
            { symbol: '♥', name: 'hearts', color: 'red' },
            { symbol: '♦', name: 'diamonds', color: 'red' },
            { symbol: '♠', name: 'spades', color: 'black' },
            { symbol: '♣', name: 'clubs', color: 'black' }
        ];

        let selectedCards = [];
        let currentFilter = 'all';

        // ============================================
        // 2. INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize card deck
            createCardDeck();
            
            // Initialize position selector
            initPositionSelector();
            
            // Initialize stack slider
            initStackSlider();
            
            // Initialize suit filter
            initSuitFilter();
            
            // Initialize chart buttons
            initCharts();
            
            // Get initial advice
            setTimeout(getAdvice, 500);
        });

        // ============================================
        // 3. CREATE VISUAL CARD DECK
        // ============================================
        function createCardDeck() {
            const cardDeck = document.getElementById('cardDeck');
            cardDeck.innerHTML = '';
            
            // Create all 52 cards
            suits.forEach(suit => {
                if (currentFilter !== 'all' && currentFilter !== suit.symbol) return;
                
                ranks.forEach(rank => {
                    const card = document.createElement('div');
                    card.className = `card ${suit.color}`;
                    card.dataset.rank = rank;
                    card.dataset.suit = suit.symbol;
                    card.dataset.color = suit.color;
                    
                    // Check if this card is already selected
                    const isSelected = selectedCards.some(c => 
                        c.rank === rank && c.suit === suit.symbol
                    );
                    
                    if (isSelected) {
                        card.classList.add('selected');
                    }
                    
                    // Card content
                    card.innerHTML = `
                        <div class="card-rank">${rank}</div>
                        <div class="card-suit">${suit.symbol}</div>
                    `;
                    
                    // Click event
                    card.addEventListener('click', function() {
                        toggleCardSelection(rank, suit.symbol, suit.color);
                    });
                    
                    cardDeck.appendChild(card);
                });
            });
            
            updateCardSlots();
        }

        // ============================================
        // 4. CARD SELECTION LOGIC
        // ============================================
        function toggleCardSelection(rank, suit, color) {
            const cardIndex = selectedCards.findIndex(c => 
                c.rank === rank && c.suit === suit
            );
            
            if (cardIndex !== -1) {
                // Card already selected - remove it
                selectedCards.splice(cardIndex, 1);
            } else {
                // Card not selected - add it if we have less than 2
                if (selectedCards.length < 2) {
                    selectedCards.push({ rank, suit, color });
                } else {
                    // Replace the first card
                    selectedCards[0] = { rank, suit, color };
                }
            }
            
            // Update UI
            createCardDeck(); // Recreate deck to update selected state
            updateCardSlots();
            updateHandDisplay();
            
            // Auto-get advice when 2 cards selected
            if (selectedCards.length === 2) {
                getAdvice();
            }
        }

        function updateCardSlots() {
            const slot1 = document.getElementById('cardSlot1');
            const slot2 = document.getElementById('cardSlot2');
            
            // Clear slots
            slot1.innerHTML = '<i class="fas fa-plus" style="color: var(--text-secondary); font-size: 40px;"></i>';
            slot2.innerHTML = '<i class="fas fa-plus" style="color: var(--text-secondary); font-size: 40px;"></i>';
            slot1.classList.remove('filled');
            slot2.classList.remove('filled');
            
            // Fill slots with selected cards
            selectedCards.forEach((card, index) => {
                const slot = index === 0 ? slot1 : slot2;
                slot.innerHTML = `
                    <div style="font-size: 40px; font-weight: 800; color: ${card.color === 'red' ? '#FF4757' : '#2F3542'}">
                        ${card.rank}
                    </div>
                    <div style="font-size: 48px; color: ${card.color === 'red' ? '#FF4757' : '#2F3542'}">
                        ${card.suit}
                    </div>
                `;
                slot.classList.add('filled');
            });
        }

        function updateHandDisplay() {
            const handDisplay = document.getElementById('handDisplay');
            
            if (selectedCards.length === 0) {
                handDisplay.textContent = 'Select 2 cards';
                return;
            }
            
            if (selectedCards.length === 1) {
                handDisplay.textContent = 'Select 1 more card';
                return;
            }
            
            // We have 2 cards - create poker hand notation
            const card1 = selectedCards[0];
            const card2 = selectedCards[1];
            
            // Sort cards by rank value for consistent display
            const rankOrder = { 'A': 14, 'K': 13, 'Q': 12, 'J': 11, 'T': 10, '9': 9, '8': 8, '7': 7, '6': 6, '5': 5, '4': 4, '3': 3, '2': 2 };
            let sortedCards = [...selectedCards].sort((a, b) => rankOrder[b.rank] - rankOrder[a.rank]);
            
            if (sortedCards[0].rank === sortedCards[1].rank) {
                // Pair
                handDisplay.textContent = `${sortedCards[0].rank}${sortedCards[1].rank}`;
            } else if (sortedCards[0].suit === sortedCards[1].suit) {
                // Suited
                handDisplay.textContent = `${sortedCards[0].rank}${sortedCards[1].rank}s`;
            } else {
                // Offsuit
                handDisplay.textContent = `${sortedCards[0].rank}${sortedCards[1].rank}o`;
            }
            
            // Also update result cards display
            updateResultCards();
        }

        function updateResultCards() {
            const resultCards = document.getElementById('resultCards');
            resultCards.innerHTML = '';
            
            if (selectedCards.length !== 2) return;
            
            selectedCards.forEach(card => {
                const cardEl = document.createElement('div');
                cardEl.className = `result-card ${card.color}`;
                cardEl.innerHTML = `
                    <div style="font-size: 36px; font-weight: 800;">${card.rank}</div>
                    <div style="font-size: 48px;">${card.suit}</div>
                `;
                resultCards.appendChild(cardEl);
            });
        }

        // ============================================
        // 5. SUIT FILTER
        // ============================================
        function initSuitFilter() {
            const suitButtons = document.querySelectorAll('.suit-btn');
            suitButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    // Remove active class from all
                    suitButtons.forEach(b => b.classList.remove('active'));
                    // Add active to clicked
                    this.classList.add('active');
                    // Update filter
                    currentFilter = this.dataset.suit;
                    // Recreate deck with filter
                    createCardDeck();
                });
            });
        }

        // ============================================
        // 6. POSITION AND STACK
        // ============================================
        function initPositionSelector() {
            const positionOptions = document.querySelectorAll('.position-option');
            positionOptions.forEach(option => {
                option.addEventListener('click', function() {
                    positionOptions.forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                    getAdvice();
                });
            });
        }

        function initStackSlider() {
            const slider = document.getElementById('stackSlider');
            const display = document.getElementById('stackValue');
            
            slider.addEventListener('input', function() {
                display.textContent = this.value + ' BB';
                getAdvice();
            });
        }

        function getCurrentPosition() {
            const activeOption = document.querySelector('.position-option.active');
            return activeOption ? activeOption.dataset.position : 'BTN';
        }

        // ============================================
        // 7. POKER CHART DATABASE
        // ============================================
        const chartDatabase = {
            "3W_SBvsBU_MR_16-20BB": {
                name: "3W - SB vs BU Min-Raise (16-20BB)",
                hands: {
                    "AA": "ALL-IN", "KK": "ALL-IN", "QQ": "ALL-IN", "JJ": "ALL-IN",
                    "TT": "ALL-IN", "99": "ALL-IN", "88": "ALL-IN", "AKs": "ALL-IN",
                    "AQs": "ALL-IN", "AJs": "CALL", "ATs": "CALL", "A9s": "CALL",
                    "A8s": "CALL", "A7s": "CALL", "A6s": "CALL", "A5s": "CALL",
                    "A4s": "CALL", "A3s": "CALL", "A2s": "CALL", "KQs": "CALL",
                    "KJs": "CALL", "KTs": "CALL", "K9s": "CALL", "K8s": "CALL",
                    "K7s": "CALL", "K6s": "CALL", "QJs": "CALL", "QTs": "CALL",
                    "Q9s": "CALL", "JTs": "CALL", "J9s": "CALL", "T9s": "CALL",
                    "98s": "CALL", "87s": "CALL", "76s": "CALL", "65s": "CALL",
                    "54s": "CALL", "AKo": "ALL-IN", "AQo": "ALL-IN", "AJo": "CALL",
                    "ATo": "CALL", "KQo": "CALL", "QJo": "FOLD", "JTo": "FOLD"
                }
            },
            "3W_SBvsBU_MR_13-16BB": {
                name: "3W - SB vs BU Min-Raise (13-16BB)",
                hands: {
                    "AA": "ALL-IN", "KK": "ALL-IN", "QQ": "ALL-IN", "JJ": "ALL-IN",
                    "TT": "ALL-IN", "99": "ALL-IN", "88": "ALL-IN", "AKs": "ALL-IN",
                    "AQs": "ALL-IN", "AJs": "ALL-IN", "ATs": "ALL-IN", "A9s": "ALL-IN",
                    "A8s": "CALL", "A7s": "CALL", "A6s": "CALL", "A5s": "ALL-IN",
                    "A4s": "CALL", "A3s": "CALL", "A2s": "CALL", "KQs": "ALL-IN",
                    "KJs": "CALL", "KTs": "CALL", "K9s": "CALL", "K8s": "FOLD",
                    "K7s": "FOLD", "QJs": "CALL", "QTs": "CALL", "Q9s": "CALL",
                    "JTs": "CALL", "J9s": "CALL", "T9s": "CALL", "98s": "CALL",
                    "87s": "CALL", "76s": "CALL", "65s": "CALL", "54s": "CALL",
                    "AKo": "ALL-IN", "AQo": "ALL-IN", "AJo": "ALL-IN", "ATo": "CALL",
                    "KQo": "CALL", "QJo": "FOLD", "JTo": "FOLD"
                }
            },
            "HU_BBvsSB_MR_13-16BB": {
                name: "HU - BB vs SB Min-Raise (13-16BB)",
                hands: {
                    "AA": "ALL-IN", "KK": "ALL-IN", "QQ": "ALL-IN", "JJ": "ALL-IN",
                    "TT": "ALL-IN", "99": "ALL-IN", "88": "ALL-IN", "77": "ALL-IN",
                    "66": "CALL", "55": "CALL", "44": "CALL", "33": "CALL",
                    "22": "CALL", "AKs": "ALL-IN", "AQs": "ALL-IN", "AJs": "ALL-IN",
                    "ATs": "ALL-IN", "A9s": "ALL-IN", "A8s": "ALL-IN", "A7s": "CALL",
                    "A6s": "CALL", "A5s": "CALL", "A4s": "CALL", "A3s": "CALL",
                    "A2s": "CALL", "KQs": "ALL-IN", "KJs": "ALL-IN", "KTs": "ALL-IN",
                    "K9s": "CALL", "K8s": "CALL", "K7s": "CALL", "K6s": "CALL",
                    "K5s": "CALL", "K4s": "CALL", "K3s": "CALL", "K2s": "CALL",
                    "QJs": "ALL-IN", "QTs": "CALL", "Q9s": "CALL", "Q8s": "CALL",
                    "JTs": "CALL", "J9s": "CALL", "J8s": "CALL", "T9s": "CALL",
                    "T8s": "CALL", "98s": "CALL", "97s": "CALL", "87s": "CALL",
                    "86s": "CALL", "76s": "CALL", "75s": "CALL", "65s": "CALL",
                    "64s": "CALL", "54s": "CALL", "53s": "CALL", "AKo": "ALL-IN",
                    "AQo": "ALL-IN", "AJo": "ALL-IN", "ATo": "CALL", "A9o": "CALL",
                    "KQo": "ALL-IN", "KJo": "CALL", "KTo": "CALL", "QJo": "CALL",
                    "QTo": "CALL", "JTo": "CALL", "T9o": "CALL", "98o": "CALL"
                }
            }
        };

        // ============================================
        // 8. ADVICE LOGIC
        // ============================================
        function getHandNotation() {
            if (selectedCards.length !== 2) return '';
            
            const card1 = selectedCards[0];
            const card2 = selectedCards[1];
            
            // Sort by rank value
            const rankOrder = { 'A': 14, 'K': 13, 'Q': 12, 'J': 11, 'T': 10, '9': 9, '8': 8, '7': 7, '6': 6, '5': 5, '4': 4, '3': 3, '2': 2 };
            let sortedCards = [...selectedCards].sort((a, b) => rankOrder[b.rank] - rankOrder[a.rank]);
            
            if (sortedCards[0].rank === sortedCards[1].rank) {
                // Pair
                return `${sortedCards[0].rank}${sortedCards[1].rank}`;
            } else if (sortedCards[0].suit === sortedCards[1].suit) {
                // Suited
                return `${sortedCards[0].rank}${sortedCards[1].rank}s`;
            } else {
                // Offsuit
                return `${sortedCards[0].rank}${sortedCards[1].rank}o`;
            }
        }

        function getRecommendation(position, stack, stage, action, hand) {
            // Build chart key based on inputs
            let chartKey = '';
            let confidence = 0.95;
            
            // 3-Handed rules
            if (stage === '3way') {
                if (position === 'SB' && action === 'MR') {
                    if (stack >= 16 && stack <= 20) {
                        chartKey = '3W_SBvsBU_MR_16-20BB';
                    } else if (stack >= 13 && stack < 16) {
                        chartKey = '3W_SBvsBU_MR_13-16BB';
                    }
                }
            }
            
            // Heads-Up rules
            if (stage === 'HU') {
                if (position === 'BB' && action === 'MR') {
                    if (stack >= 13 && stack <= 16) {
                        chartKey = 'HU_BBvsSB_MR_13-16BB';
                    }
                }
            }
            
            // If no chart found, use first available
            if (!chartKey) {
                chartKey = Object.keys(chartDatabase)[0];
                confidence = 0.7;
            }
            
            // Get recommendation from chart
            const chart = chartDatabase[chartKey];
            let recommendation = chart.hands[hand];
            
            // If hand not found in chart
            if (!recommendation) {
                // Try without suit indicator
                const handBase = hand.replace(/[so]$/, '');
                for (const [chartHand, action] of Object.entries(chart.hands)) {
                    if (chartHand.replace(/[so]$/, '') === handBase) {
                        recommendation = action;
                        confidence = 0.8;
                        break;
                    }
                }
                
                // If still not found, default to FOLD
                if (!recommendation) {
                    recommendation = 'FOLD';
                    confidence = 0.6;
                }
            }
            
            return {
                hand: hand,
                recommendation: recommendation,
                chartKey: chartKey,
                chartName: chart.name,
                confidence: confidence
            };
        }

        function getAdvice() {
            // Get inputs
            const position = getCurrentPosition();
            const stack = parseInt(document.getElementById('stackSlider').value);
            const stage = document.getElementById('gameStage').value;
            const action = document.getElementById('actionFacing').value;
            const hand = getHandNotation();
            
            // Update info display
            document.getElementById('infoPosition').textContent = position;
            document.getElementById('infoStack').textContent = stack + ' BB';
            document.getElementById('infoStage').textContent = stage === '3way' ? '3-Handed' : 'Heads-Up';
            document.getElementById('infoAction').textContent = getActionName(action);
            
            if (!hand) {
                // No hand selected
                document.getElementById('recommendationAction').textContent = 'SELECT 2 CARDS';
                document.getElementById('recommendationAction').className = 'recommendation-action';
                document.getElementById('recommendationExplanation').textContent = 'Click two cards above';
                document.getElementById('confidenceBar').style.width = '0%';
                return;
            }
            
            // Get recommendation
            const result = getRecommendation(position, stack, stage, action, hand);
            
            // Update recommendation display
            const recommendationEl = document.getElementById('recommendationAction');
            recommendationEl.textContent = result.recommendation;
            recommendationEl.className = 'recommendation-action';
            
            if (result.recommendation.includes('ALL-IN')) {
                recommendationEl.classList.add('allin');
            } else if (result.recommendation.includes('CALL')) {
                recommendationEl.classList.add('call');
            } else if (result.recommendation.includes('RAISE')) {
                recommendationEl.classList.add('raise');
            } else if (result.recommendation.includes('FOLD')) {
                recommendationEl.classList.add('fold');
            }
            
            // Update explanation
            document.getElementById('recommendationExplanation').textContent = result.chartName;
            
            // Update confidence
            const confidencePercent = Math.round(result.confidence * 100);
            document.getElementById('confidenceBar').style.width = confidencePercent + '%';
            
            // Highlight chart
            highlightChart(result.chartKey);
            
            // Add animation
            recommendationEl.classList.add('slide-in');
            setTimeout(() => {
                recommendationEl.classList.remove('slide-in');
            }, 300);
        }

        // ============================================
        // 9. CHARTS MANAGEMENT
        // ============================================
        function initCharts() {
            const chartButtons = document.getElementById('chartButtons');
            chartButtons.innerHTML = '';
            
            for (const chartKey in chartDatabase) {
                const chart = chartDatabase[chartKey];
                const button = document.createElement('div');
                button.className = 'chart-btn';
                button.textContent = chart.name;
                button.dataset.chart = chartKey;
                
                button.addEventListener('click', function() {
                    document.querySelectorAll('.chart-btn').forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    displayChart(chartKey);
                });
                
                chartButtons.appendChild(button);
            }
            
            // Activate first chart
            if (chartButtons.firstChild) {
                chartButtons.firstChild.classList.add('active');
                displayChart(chartButtons.firstChild.dataset.chart);
            }
        }

        function displayChart(chartKey) {
            const chart = chartDatabase[chartKey];
            const chartDisplay = document.getElementById('chartDisplay');
            
            if (!chart) return;
            
            let html = `<h3 style="margin-bottom: 20px;">${chart.name}</h3>`;
            
            // Group hands by action
            const actions = {};
            for (const [hand, action] of Object.entries(chart.hands)) {
                if (!actions[action]) actions[action] = [];
                actions[action].push(hand);
            }
            
            // Display each action group
            for (const [action, hands] of Object.entries(actions)) {
                let color = 'var(--text-secondary)';
                if (action.includes('ALL-IN')) color = 'var(--allin-color)';
                else if (action.includes('CALL')) color = 'var(--call-color)';
                else if (action.includes('RAISE')) color = 'var(--raise-color)';
                else if (action.includes('FOLD')) color = 'var(--fold-color)';
                
                html += `
                    <div style="margin-bottom: 15px;">
                        <div style="color: ${color}; font-weight: 600; margin-bottom: 10px;">
                            ${action} (${hands.length} hands)
                        </div>
                        <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                `;
                
                hands.sort().forEach(hand => {
                    html += `<div style="background: var(--border); padding: 6px 12px; border-radius: 6px; font-size: 14px;">${hand}</div>`;
                });
                
                html += `</div></div>`;
            }
            
            chartDisplay.innerHTML = html;
        }

        function highlightChart(chartKey) {
            document.querySelectorAll('.chart-btn').forEach(btn => btn.classList.remove('active'));
            const matchingBtn = document.querySelector(`.chart-btn[data-chart="${chartKey}"]`);
            if (matchingBtn) {
                matchingBtn.classList.add('active');
                displayChart(chartKey);
            }
        }

        // ============================================
        // 10. HELPER FUNCTIONS
        // ============================================
        function getActionName(actionCode) {
            const actionMap = {
                'Fold': 'Fold',
                'Limp': 'Limp',
                'MR': 'Min-Raise',
                '25x': 'Raise 2.5x',
                '3x': 'Raise 3x',
                'AI': 'All-In'
            };
            return actionMap[actionCode] || actionCode;
        }

        // ============================================
        // 11. EVENT LISTENERS
        // ============================================
        document.getElementById('getAdviceBtn').addEventListener('click', getAdvice);
        document.getElementById('gameStage').addEventListener('change', getAdvice);
        document.getElementById('actionFacing').addEventListener('change', getAdvice);
        
        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                getAdvice();
            } else if (e.key === 'Escape') {
                selectedCards = [];
                createCardDeck();
                updateCardSlots();
                updateHandDisplay();
            }
        });
        
        // Clear selection on double-click deck
        document.getElementById('cardDeck').addEventListener('dblclick', function() {
            selectedCards = [];
            createCardDeck();
            updateCardSlots();
            updateHandDisplay();
        });
    </script>
</body>
</html>